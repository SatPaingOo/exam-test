import{r as e,a,j as r,C as s,I as t,B as i,L as l,s as n,_ as o}from"./index-435157c8.js";import{b as m}from"./index-0dccc7cd.js";const d=()=>{const[d,u]=e.useState({username:"",password:"",confirmPassword:"",email:"",fullName:""}),[c,h]=e.useState({}),[p,g]=e.useState(!1),w=a(),f=(e,a)=>{u(r=>({...r,[e]:a})),c[e]&&h(a=>({...a,[e]:""}))};return r.jsx("div",{className:"register",children:r.jsx("div",{className:"container",children:r.jsxs(s,{className:"register__card",children:[r.jsx("h1",{className:"register__title",children:"Create Account"}),r.jsx("p",{className:"register__subtitle",children:"Join us to start your exam preparation journey"}),r.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};return d.username.trim()?d.username.length<3&&(e.username="Username must be at least 3 characters"):e.username="Username is required",d.password?d.password.length<6&&(e.password="Password must be at least 6 characters"):e.password="Password is required",d.password!==d.confirmPassword&&(e.confirmPassword="Passwords do not match"),d.email.trim()?/\S+@\S+\.\S+/.test(d.email)||(e.email="Please enter a valid email address"):e.email="Email is required",h(e),0===Object.keys(e).length})()){g(!0);try{const{data:e,error:r}=await n.from("users").select("username, email").or(`username.eq.${d.username.trim()},email.eq.${d.email.trim()}`).single();if(e)return void(e.username===d.username.trim()?h({username:"Username already exists"}):h({email:"Email already exists"}));const s=10,t=await m.hash(d.password,s),i=`member-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,{data:l,error:u}=await n.from("users").insert({uuid:i,username:d.username.trim(),password_hash:t,email:d.email.trim(),full_name:d.fullName.trim()||null,role:"member"}).select().single();if(u)throw u;try{const{logSuccess:e}=await o(()=>import("./index-435157c8.js").then(e=>e.i),["assets/index-435157c8.js","assets/index-94d838fc.css"]),a=(await o(()=>import("./index-435157c8.js").then(e=>e.h),["assets/index-435157c8.js","assets/index-94d838fc.css"])).getUuid();e("User registered",{},{action:"register",actor_type:"user",actor_id:l.id,user_id:l.id,metadata:{username:l.username},visitor_uuid:a})}catch(a){}alert("Registration successful! Please login with your credentials."),w("/login")}catch(r){alert("Registration failed. Please try again.")}finally{g(!1)}}},className:"register__form",children:[r.jsx(t,{label:"Username *",type:"text",name:"username",value:d.username,onChange:e=>f("username",e.target.value),error:c.username,placeholder:"Choose a username",required:!0}),r.jsx(t,{label:"Email *",type:"email",name:"email",value:d.email,onChange:e=>f("email",e.target.value),error:c.email,placeholder:"Enter your email address",required:!0}),r.jsx(t,{label:"Full Name",type:"text",name:"fullName",value:d.fullName,onChange:e=>f("fullName",e.target.value),placeholder:"Enter your full name (optional)"}),r.jsx(t,{label:"Password *",type:"password",name:"password",value:d.password,onChange:e=>f("password",e.target.value),error:c.password,placeholder:"Create a password",required:!0}),r.jsx(t,{label:"Confirm Password *",type:"password",name:"confirmPassword",value:d.confirmPassword,onChange:e=>f("confirmPassword",e.target.value),error:c.confirmPassword,placeholder:"Confirm your password",required:!0}),Object.keys(c).length>0&&r.jsx("div",{className:"register__errors",children:r.jsx("p",{children:"Please fix the errors above and try again."})}),r.jsx(i,{type:"submit",variant:"primary",size:"large",fullWidth:!0,className:"register__button",disabled:p,children:p?"Creating Account...":"Create Account"})]}),r.jsx("div",{className:"register__footer",children:r.jsxs("p",{children:["Already have an account?"," ",r.jsx(l,{to:"/login",className:"register__link",children:"Sign in here"})]})})]})})})};export{d as default};
