import{r as s,s as e,j as a,b as l,I as t,B as i,C as n,P as r}from"./index-09ec34ef.js";const c=()=>{const[c,o]=s.useState([]),[d,m]=s.useState(!0),[g,h]=s.useState(""),[u,p]=s.useState(""),[x,j]=s.useState(1),[_,N]=s.useState(25);s.useEffect(()=>{v()},[]);const v=async()=>{try{const{data:s,error:a}=await e.from("logs").select("*").order("occurred_at",{ascending:!1}).limit(100);if(a)throw a;o(s||[])}catch(s){}finally{m(!1)}},y=c.filter(s=>{var e,a;const l=!g||s.type===g,t=!u||s.message.toLowerCase().includes(u.toLowerCase())||(null==(e=s.action)?void 0:e.toLowerCase().includes(u.toLowerCase()))||(null==(a=s.page)?void 0:a.toLowerCase().includes(u.toLowerCase()));return l&&t}),f=y.length,C=(x-1)*_,w=C+_,S=y.slice(C,w);s.useEffect(()=>{j(1)},[g,u]);const L=s=>{switch(s){case"error":return"log-type--error";case"success":return"log-type--success";case"info":return"log-type--info";case"warning":return"log-type--warning";default:return"log-type--default"}},b=[...new Set(c.map(s=>s.type))];return d?a.jsx("div",{className:"admin-logs",children:a.jsx("div",{className:"container",children:a.jsx("div",{className:"loading-screen",children:a.jsx("p",{children:"Loading logs..."})})})}):a.jsx("div",{className:"admin-logs",children:a.jsxs("div",{className:"container",children:[a.jsxs("div",{className:"admin-logs__header",children:[a.jsx("h1",{className:"admin-logs__title",children:"System Logs"}),a.jsx("p",{className:"admin-logs__subtitle",children:"Monitor system activity and troubleshoot issues"})]}),a.jsxs("div",{className:"admin-logs__filters",children:[a.jsxs("div",{className:"admin-logs__filter-group",children:[a.jsx(l,{value:g,onChange:s=>h(s.target.value),options:[{value:"",label:"All Types"},...b.map(s=>({value:s,label:s.toUpperCase()}))],className:"admin-logs__filter-select"}),a.jsx(t,{type:"text",placeholder:"Search logs...",value:u,onChange:s=>p(s.target.value),className:"admin-logs__search-input"})]}),a.jsx(i,{onClick:v,variant:"secondary",children:"Refresh"})]}),a.jsxs(n,{className:"admin-logs__card",children:[a.jsxs("div",{className:"admin-logs__stats",children:[a.jsxs("div",{className:"stat-item",children:[a.jsx("span",{className:"stat-value",children:c.length}),a.jsx("span",{className:"stat-label",children:"Total Logs"})]}),a.jsxs("div",{className:"stat-item",children:[a.jsx("span",{className:"stat-value",children:c.filter(s=>"error"===s.type).length}),a.jsx("span",{className:"stat-label",children:"Errors"})]}),a.jsxs("div",{className:"stat-item",children:[a.jsx("span",{className:"stat-value",children:c.filter(s=>"success"===s.type).length}),a.jsx("span",{className:"stat-label",children:"Success"})]})]}),a.jsx("div",{className:"admin-logs__list",children:0===S.length?a.jsx("p",{className:"admin-logs__empty",children:u||g?"No logs found matching your filters.":"No logs found."}):S.map(s=>a.jsxs("div",{className:"log-item",children:[a.jsxs("div",{className:"log-item__header",children:[a.jsx("span",{className:`log-type ${L(s.type)}`,children:s.type.toUpperCase()}),a.jsx("span",{className:"log-item__timestamp",children:new Date(s.occurred_at||s.timestamp).toLocaleString()})]}),a.jsxs("div",{className:"log-item__content",children:[a.jsx("p",{className:"log-item__message",children:s.message}),a.jsxs("div",{className:"log-item__meta",children:[s.page&&a.jsxs("span",{children:["Page: ",s.page]}),s.action&&a.jsxs("span",{children:["Action: ",s.action]}),s.user_id&&a.jsxs("span",{children:["User ID: ",s.user_id]}),s.visitor_uuid&&a.jsxs("span",{children:["UUID: ",s.visitor_uuid]}),s.actor_type&&a.jsxs("span",{children:["Actor: ",s.actor_type]})]}),s.details&&a.jsxs("details",{className:"log-item__details",children:[a.jsx("summary",{children:"Details"}),a.jsx("pre",{children:JSON.stringify(s.details,null,2)})]})]})]},s.id))}),f>_&&a.jsx(r,{currentPage:x,totalItems:f,itemsPerPage:_,onPageChange:j,onItemsPerPageChange:N})]})]})})};export{c as default};
