import{c as s,e,a as r,r as t,u as a,j as i,g as n,s as o,l as c,f as u}from"./index-004cc2d7.js";import{g as d,r as m}from"./examData-6788a30d.js";import"./dummy-e365b94c.js";const l=()=>{const{track:l,paper:f}=s(),[g]=e(),h=r(),p=t.useRef(!1),{user:x}=a(),q=Math.max(1,Math.min(100,parseInt(g.get("count")||"20",10))),j=g.get("session")||"both";return t.useEffect(()=>{if(p.current)return;p.current=!0;(async()=>{if(d(l))try{const{questions:s}=await m(l,f);let e=Array.isArray(s)?s:[];"both"!==j&&(e=e.filter(s=>s.session===j));const r=function(s,e){const r=s.slice();for(let t=r.length-1;t>0;t--){const s=Math.floor(Math.random()*(t+1));[r[t],r[s]]=[r[s],r[t]]}return r.slice(0,e)}(e,Math.min(q,e.length||q)),t=n(),a=Date.now().toString(36)+Math.random().toString(36).substring(2,8),i={code:a,uuid:t,user_id:null==x?void 0:x.id,track:l,paper:f,finished:!1,questions:r,answers:{}},{data:d,error:g}=await o.from("quiz_sessions").insert([i]).select("id").single();g?(c("Error creating quiz session",{error:g.message}),h("/exams")):(u("Quiz session created",{sessionId:d.id}),h(`/quiz/session/${a}`))}catch(s){c("Error starting quiz",{error:s.message}),h("/exams")}else h("/exams")})()},[l,f,q,j]),i.jsx("div",{className:"quiz-start",children:i.jsx("div",{className:"container",children:i.jsx("p",{children:"Starting quiz..."})})})};export{l as default};
